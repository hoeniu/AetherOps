from typing import Dict, List, Any

def get_log_tags_tree() -> List[Dict[str, Any]]:
    """
    将log_tags_relation字典转换为tag_tree格式
    
    Returns:
        包含嵌套标签结构的列表
    """
    tag_tree = []
    
    for parent_tag, child_tags in log_tags_relation.items():
        parent_node = {
            "label": parent_tag,
            "children": [{"label": child_tag} for child_tag in child_tags]
        }
        tag_tree.append(parent_node)
    
    return tag_tree

log_tags_relation = {
    '系统错误': [
        '系统崩溃',
        '服务异常',
        '资源耗尽',
        '进程异常',
        '系统负载过高'
    ],
    '性能指标': [
        'CPU使用率',
        '内存使用率',
        '磁盘使用率',
        '网络带宽',
        '响应时间',
        '并发连接数',
        '队列长度'
    ],
    '安全事件': [
        '未授权访问',
        '异常登录',
        '数据泄露',
        '恶意攻击',
        '配置错误',
        '权限变更'
    ],
    '业务指标': [
        '请求量',
        '成功率',
        '业务异常',
        '接口调用',
        '数据处理',
        '业务延迟'
    ],
    '系统状态': [
        '服务状态',
        '资源状态',
        '依赖服务',
        '系统告警',
        '健康检查',
        '配置变更'
    ]
}

log_tags_relation_reverse = {}
for parent, children in log_tags_relation.items():
    for child in children:
        log_tags_relation_reverse[child] = parent

log_tag_explanation = {
    # 系统错误
    '系统崩溃': '系统发生严重错误导致服务完全停止',
    '服务异常': '服务运行异常但未完全停止',
    '资源耗尽': '系统资源（CPU、内存、磁盘等）使用达到上限',
    '进程异常': '进程异常退出或行为异常',
    '系统负载过高': '系统整体负载超过正常阈值',
    
    # 性能指标
    'CPU使用率': 'CPU资源使用情况，包括用户态和系统态',
    '内存使用率': '内存资源使用情况，包括物理内存和虚拟内存',
    '磁盘使用率': '磁盘空间和IO使用情况',
    '网络带宽': '网络流量和带宽使用情况',
    '响应时间': '服务请求响应时间',
    '并发连接数': '当前并发连接数量',
    '队列长度': '任务队列等待长度',
    
    # 安全事件
    '未授权访问': '检测到未授权的访问尝试',
    '异常登录': '检测到异常的登录行为',
    '数据泄露': '检测到可能的数据泄露事件',
    '恶意攻击': '检测到恶意攻击行为',
    '配置错误': '安全配置出现错误',
    '权限变更': '系统权限发生变更',
    
    # 业务指标
    '请求量': '业务请求数量统计',
    '成功率': '业务请求成功率',
    '业务异常': '业务处理过程中的异常',
    '接口调用': '接口调用情况统计',
    '数据处理': '数据处理相关指标',
    '业务延迟': '业务处理延迟情况',
    
    # 系统状态
    '服务状态': '各个服务的运行状态',
    '资源状态': '系统资源使用状态',
    '依赖服务': '依赖服务的状态',
    '系统告警': '系统产生的告警信息',
    '健康检查': '系统健康检查结果',
    '配置变更': '系统配置变更记录'
}

log_tag_query_map = {
    '系统错误': [
        '系统崩溃原因分析',
        '服务异常处理流程',
        '资源耗尽解决方案',
        '进程异常排查方法',
        '系统负载优化建议'
    ],
    '性能指标': [
        'CPU使用率优化',
        '内存使用率分析',
        '磁盘使用率监控',
        '网络带宽优化',
        '响应时间优化',
        '并发连接数调优',
        '队列长度优化'
    ],
    '安全事件': [
        '未授权访问处理',
        '异常登录分析',
        '数据泄露防护',
        '恶意攻击防御',
        '配置错误修复',
        '权限变更审计'
    ],
    '业务指标': [
        '请求量分析',
        '成功率优化',
        '业务异常处理',
        '接口调用优化',
        '数据处理优化',
        '业务延迟分析'
    ],
    '系统状态': [
        '服务状态监控',
        '资源状态分析',
        '依赖服务检查',
        '系统告警处理',
        '健康检查优化',
        '配置变更管理'
    ]
} 